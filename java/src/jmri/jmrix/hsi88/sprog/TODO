Does this not duplicate the code in serialdriver?
